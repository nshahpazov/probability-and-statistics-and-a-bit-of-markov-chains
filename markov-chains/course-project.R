p1 = 0.04
p2 = 0.03
p3 = 0.01
p4 = 0.002
p5 = 1 - (p1 + p2 + p3 + p4)
p6 = p4 + p3
p7 = p4 + p3 + p2
p8 = p4 + p3 + p2 + p1

P=t(matrix(c(# 1   2   3   4   5   6   7   8   9   10  11  12
               p5, 0,  p1, p2, p3, 0,  0,  0,  p4, 0,  0,  0,  #  1
               p5, 0,  0,  p1, p2, p3, 0,  0,  0,  p4, 0,  0,  #  2
               0,  p5, 0,  0,  p1, p2, p3, 0,  0,  0,  p4, 0,  #  3
               0,  0,  p5, 0,  0,  p1, p2, p3, 0,  0,  0,  p4, #  4
               0,  0,  0,  p5, 0,  0,  p1, p2, p3, 0,  0,  p4, #  5
               0,  0,  0,  0,  p5, 0,  0,  p1, p2, p3, 0,  p4, #  6
               0,  0,  0,  0,  0,  p5, 0,  0,  p1, p2, p3, p4, #  7
               0,  0,  0,  0,  0,  0,  p5, 0,  0,  p1, p2, p6, #  8
               0,  0,  0,  0,  0,  0,  0,  p5, 0,  0,  p1, p7, #  9
               0,  0,  0,  0,  0,  0,  0,  0,  p5, 0,  0,  p8, #  10
               0,  0,  0,  0,  0,  0,  0,  0,  0,  p5, 0,  p8, #  11
               0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  p5, p8), #  12
           nrow=12))

n = 150
nth.time = matrix.power(P, n)
st = c(0.00546708591, 0.00413529481, 0.00184971384, 0.0012316719, 0.000734475207)

stationary = (matrix.power(P, 10000))[1,]
stationary - stationary%*%P == 0 # check whether it is a stationary distribution
x[1, ]
